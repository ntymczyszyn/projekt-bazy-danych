{% extends 'base_doctor.html' %}
{% load static %}
{% block content %}

<div class="container2" style="position:absolute; top: 30%; left: 30%; width: 40vw">
    <h2>Przeszłe wizyty</h2>
    {% if past_appointments %}
        {% regroup past_appointments by service_id.specialzation_id as grouped_past_appointments %}
        {% for specialization, appointments in grouped_past_appointments %}
            <h3>{{ specialization }}</h3>
            <ul class="appointments">  
                {% regroup appointments by status as grouped_appointments %}
                {% for status, status_appointments in grouped_appointments %}
                    <h4>{% if status == 'c' %}Zrealizowane{% else %}Niezrealizowane{% endif %}</h4>
                    {% for appointment in status_appointments %} 
                    {% comment %} te style to tak tymczasowo {% endcomment %}
                        <a href="{% url 'appointment_detail' pk=appointment.id %}"  style="text-decoration: none; color: white">
                        <li>        
                            {% if status == 'c' %}{{ appointment.patient_id }}{% endif %}
                        </li>
                        <li>        
                            {{ appointment.formatted_appointment_time }} - {{ appointment.facility_id }}
                        </li>
                        </a>
                        <br>
                    {% endfor %}
                    <p>Liczba wizyt: {{ status_appointments|length }}</p>
                {% endfor %}
            </ul>
        {% endfor %}
    {% else %}
        <p>Brak przeszłych wizyt.</p>
    {% endif %} 
</div>

{% endblock %}
